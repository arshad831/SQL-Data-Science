
1. How many films are there in the film table?


Copy code
SELECT COUNT(*) as num_films
FROM film;


2. What are the names of the top 10 most rented films, based on the inventory and rental tables?


SELECT f.title, COUNT(r.invent
ory_id) as num_rentals
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.film_id
ORDER BY num_rentals DESC
LIMIT 10;

3. What is the average rental duration for all rentals, based on the rental table?

SELECT AVG(DATEDIFF(return_date, rental_date)) as avg_duration
FROM rental;


4. How many customers live in each city, based on the customer and address tables?

SELECT a.city, COUNT(c.customer_id) as num_customers
FROM customer c
JOIN address a ON c.address_id = a.address_id
GROUP BY a.city;

5. What is the total rental revenue generated by each staff member, based on the staff and payment tables?

SELECT s.first_name, s.last_name, SUM(p.amount) as total_revenue
FROM staff s
JOIN payment p ON s.staff_id = p.staff_id
GROUP BY s.staff_id;
Note: These are just a few examples, and there are many more questions you can ask using the Sakila database.



6. What is the average rental duration for customers who have rented more than 10 films, based on the customer and rental tables?

SELECT AVG(DATEDIFF(r.return_date, r.rental_date)) as avg_duration
FROM rental r
JOIN (
  SELECT customer_id, COUNT(*) as num_rentals
  FROM rental
  GROUP BY customer_id
  HAVING num_rentals > 10
) as rental_counts ON r.customer_id = rental_counts.customer_id;

7. What is the most popular rental category, based on the film_category and inventory tables?

SELECT c.name, COUNT(i.inventory_id) as num_films
FROM film_category fc
JOIN category c ON fc.category_id = c.category_id
JOIN inventory i ON fc.film_id = i.film_id
GROUP BY c.category_id
ORDER BY num_films DESC
LIMIT 1;

8. What is the average rental duration for films in each rental category, based on the film_category, inventory, and rental tables?


SELECT c.name, AVG(DATEDIFF(r.return_date, r.rental_date)) as avg_duration
FROM film_category fc
JOIN category c ON fc.category_id = c.category_id
JOIN inventory i ON fc.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY c.category_id;

9. What is the most profitable film in terms of rental revenue, based on the film, inventory, and payment tables?

SELECT f.title, SUM(p.amount) as total_revenue
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY f.film_id
ORDER BY total_revenue DESC
LIMIT 1;

10. What is the most popular rental category for customers who have rented more than 10 films, based on the customer, film_category, inventory, and rental tables?

SELECT c.name, COUNT(i.inventory_id) as num_films
FROM film_category fc
JOIN category c ON fc.category_id = c.category_id
JOIN inventory i ON fc.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN (
  SELECT customer_id, COUNT(*) as num_rentals
  FROM rental
  GROUP BY customer_id
  HAVING num_rentals > 10
) as rental_counts ON r.customer_id = rental_counts.customer_id
GROUP BY c.category_id
ORDER BY num_films DESC
LIMIT 1;
